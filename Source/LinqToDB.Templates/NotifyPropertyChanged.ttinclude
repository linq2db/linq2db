<#@ include file="T4Model.ttinclude" once="true" #>
<#
	{
		var beforeGenerateModel = BeforeGenerateModel;
		BeforeGenerateModel = () =>
		{
			beforeGenerateModel();
			CodeTemplateGenerator.NotifyPropertyChangedImplementation<MemberGroup,Method,Field,Event,Attribute>();
		};

		SetPropertyValueAction += (obj,prop,val) =>
		{
			if (prop == "IsNotifying")
				obj.IsNotifying = (bool)val;
		};
	}
#><#+
public bool ImplementNotifyPropertyChanging         { get { return CodeTemplateGenerator.ImplementNotifyPropertyChanging;         } set { CodeTemplateGenerator.ImplementNotifyPropertyChanging         = value; } }
public bool SkipNotifyPropertyChangedImplementation { get { return CodeTemplateGenerator.SkipNotifyPropertyChangedImplementation; } set { CodeTemplateGenerator.SkipNotifyPropertyChangedImplementation = value; } }

partial class Property : INotifyingPropertyProperty
{
	public bool         IsNotifying { get; set; }
	public List<string> Dependents  { get; set; } = new List<string>();
}

public class NotifyingProperty : Property
{
	public NotifyingProperty()
	{
		IsNotifying = true;
	}

	public NotifyingProperty(ModelType type, string name, params string[] dependents)
		: base(type.ToTypeName, name)
	{
		IsNotifying = true;

		if (dependents.Length == 0)
			Dependents.Add(name);
		else
			Dependents.AddRange(dependents);
	}

	public NotifyingProperty(string type, string name, params string[] dependents)
		: base(() => type, name)
	{
		IsNotifying = true;

		if (dependents.Length == 0)
			Dependents.Add(name);
		else
			Dependents.AddRange(dependents);
	}
}
#>
